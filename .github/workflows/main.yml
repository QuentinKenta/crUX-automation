name: Call Crux API

on: [workflow_dispatch]

jobs:
  call_crux_api:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '14'
      - name: Install dependencies
        run: npm install
      - name: Call CruX API and log response
        id: api
        env:
          CRUX_KEY: ${{ secrets.CRUXKEY }}
        run: node index.js >> $GITHUB_OUTPUT

      - name: Use API response in the next step
        run: | 
        response=$(cat $GITHUB_OUTPUT)
        echo "The API response is $response"
#         echo "The API originOrUrl is ${{ steps.api.outputs.originOrUrl }}" 
#         echo "The API largest_contentful_paint is ${{ steps.api.outputs.largest_contentful_paint }}"
