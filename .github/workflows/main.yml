name: Call Crux API

on: [workflow_dispatch]

jobs:
  call_crux_api:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '14'
      - name: Install dependencies
        run: npm install
      - name: Call CruX API and log response
        id: crux-api
        env:
          CRUX_KEY: ${{ secrets.CRUXKEY }}
          CRUX_RESPONSE: node index.js
        run: 
          
          echo "CRUX_RESPONSE is $CRUX_RESPONSE"

      - name: Use API response in the next step
        env :
          CRUX_RESPONSE: ${{ steps.api.outputs.CRUX_RESPONSE }}
        run: echo "The response is $CRUX_RESPONSE"

#         echo "The API originOrUrl is ${{ steps.api.outputs.originOrUrl }}" 
#         echo "The API largest_contentful_paint is ${{ steps.api.outputs.largest_contentful_paint }}"
